<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ARマップ</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/1.7.2/aframe/build/aframe-ar.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs>
        <!-- カメラ -->
        <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
        // JSONデータを取得してピンを作成
        fetch('suirotuuhou.json')
            .then(response => response.json())
            .then(data => {
                data.features.forEach(feature => {
                    const { geometry, attributes } = feature;
                    const latitude = geometry.y;
                    const longitude = geometry.x;
                    const nameParts = attributes.name.split(/[\s　、,、\-]+/);
                    const lastWord = nameParts[nameParts.length - 1];

                    // ピンを作成
                    const scene = document.querySelector('a-scene');
                    const pin = document.createElement('a-entity');

                    // ピンの見た目を設定
                    pin.setAttribute('geometry', {
                        primitive: 'cone',
                        height: 1,
                        radiusBottom: 0.5,
                        radiusTop: 0
                    });
                    pin.setAttribute('material', {
                        color: 'red'
                    });

                    // GPSデータを設定
                    pin.setAttribute('gps-entity-place', {
                        latitude: latitude,
                        longitude: longitude
                    });

                    // タップ/クリックでポップアップを表示
                    pin.addEventListener('click', () => {
                        alert(`位置情報: ${latitude}, ${longitude}\n情報: ${info}`);
                    });

                    // シーンに追加
                    scene.appendChild(pin);
                });
            })
            .catch(error => console.error("JSONデータの取得に失敗しました:", error));
    </script>
</body>
</html>
